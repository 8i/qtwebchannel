<html>
    <head>
        <script>
            document.write('<script src="' + (/[?&]webChannelBaseUrl=([A-Za-z0-9\-:/]+)/.exec(location.search)[1]) + '"><' + '/script>');
            function output(x)
            {
                document.querySelector("#out").innerHTML += x + "<br/>";
            }
        </script>
        <script>
            window.onload = function() {
                navigator.createWebChannel(function(c) {
                    c.subscribe(
                        "foobar",
                        function(message) {
                            output(message);
                        }
                    );
                    c.exec(
                        {a:"This is a request from HTML"},
                        function(response) {
                            output(response.b);
                        }
                    );
                });
            };
        </script>
    </head>
    <body>
    <a href="javascript:send()">Go</a>
    <div id="out"></div>
    </body>
</html>
